# Delivery database project

## **1. Описание предметной области**

Предметная область проекта связана с системой управления заказами для службы доставки.  
Основные цели системы:

-   Хранение данных о пользователях (клиентах).
-   Управление каталогом товаров.
-   Регистрация заказов, содержащих список товаров, их количество, и статус выполнения.
-   Подсчёт общей стоимости заказа и отслеживание его текущего состояния.

Система охватывает следующие сущности:

1.  **Пользователи (Users)** — клиенты, которые размещают заказы.
2.  **Товары (Products)** — продукция, доступная для заказа.
3.  **Заказы (Orders)** — записи о сделанных заказах, содержащие сведения о клиенте, дате заказа, общей стоимости и статусе.
4.  **Позиции заказа (OrderItems)** — детали конкретных товаров в заказе, включая их количество.

----------

## **2. Требования**

1.  **Функциональные требования**:
    
    -   Добавление, удаление и редактирование данных о пользователях, товарах и заказах.
    -   Учет статусов заказов (например, "Создан", "В обработке", "Доставлен").
    -   Отслеживание текущих запасов товаров.
    -   Автоматическое обновление общей стоимости заказа на основе добавленных товаров.
2.  **Нефункциональные требования**:
    
    -   Обеспечение целостности данных через ограничения и связи между таблицами.
    -   Эффективное выполнение запросов за счёт оптимизации структуры базы данных.
    -   Защита данных (например, уникальность email для пользователей).

----------

## **3. Схема базы данных**

![Схема базы данных](/database/database_schema.jpg)

----------

## **4. Нормальные формы (НФ) базы данных**

**Первая нормальная форма (1НФ)**:

-   Каждая таблица соответствует требованиям 1НФ, так как:
    -   Все данные атомарны (одна ячейка = одно значение).
    -   Повторяющихся столбцов нет.
    -   Каждая строка уникальна, благодаря использованию первичных ключей (`PRIMARY KEY`).

**Вторая нормальная форма (2НФ)**:

-   Таблицы находятся во 2НФ, так как:
    -   Все неключевые столбцы зависят от первичного ключа.
    -   В таблице `OrderItems`, где первичный ключ (`order_item_id`) однозначно определяет каждую строку, нет частичных зависимостей.

**Третья нормальная форма (3НФ)**:

-   Все таблицы находятся в 3НФ, так как:
    -   Все неключевые атрибуты зависят только от первичного ключа.
    -   Например, в таблице `Users` столбец `email` уникален, но не зависит от других атрибутов, кроме `user_id`.

----------

## **5. Обоснование выбора структуры базы данных**

-   Использование **таблицы `Users`** позволяет централизованно управлять данными о клиентах, сохраняя уникальность email и связь с адресами и телефонами.
-   **Таблица `Products`** предназначена для хранения информации о товарах, с возможностью отслеживания запасов.
-   **Таблица `Orders`** служит для ведения записей о заказах, привязывая их к клиентам и храня статус выполнения.
-   **Таблица `OrderItems`** обеспечивает детализацию заказов, представляя связь между товарами и конкретными заказами.

Такой дизайн позволяет эффективно выполнять запросы, сохраняет целостность данных и исключает избыточность.

## **6. How to run**

1. В папке `streamlit` создайте файл .env с следующим содержимым:

    ```
    DB_INIT_SCRIPT="database/delivery.sql"
    DB_NAME="delivery"
    DB_HOST="db"
    DB_PORT="5432"
    LOG_PATH="logging_data/delivery_connection.log"
    ADMIN_PASSWORD="chill_owner"
    ADMIN_USERNAME="chill_owner"
    ```

2. Чтобы запустить проект пропишите, скачайте Docker и запустите команду:

    ``` bash
    sudo docker compose up --build
    ```
